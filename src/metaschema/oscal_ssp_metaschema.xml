<?xml version="1.0" encoding="UTF-8"?>
<!-- ** NOTES **
- Need to check latest FR SSP template for "Privacy Impact Designation".
  Was it dropped in latest template, or is it missing from schema?
-->
<!-- OSCAL Implementation Layer: System Security Plan (SSP) METASCHEMA -->
<!-- validate with XSD and Schematron (linked) -->
<?xml-model href="../../build/metaschema/lib/metaschema-check.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<?xml-stylesheet type="text/xsl" href="metaschema-browser.xsl"?>
<?xml-stylesheet type="text/css" href="../../build/metaschema/lib/metaschema-author.css"?>
<METASCHEMA xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0"
            xmlns:o="http://csrc.nist.gov/ns/oscal/example"
            xsi:schemaLocation="http://csrc.nist.gov/ns/oscal/metaschema/1.0 ../../build/metaschema/lib/metaschema.xsd"
            root="system-security-plan">
   <schema-name>OSCAL System Security Plan (SSP) Format</schema-name>
   <schema-version>1.0.0-milestone2</schema-version>
   <short-name>oscal-ssp</short-name>
   <namespace>http://csrc.nist.gov/ns/oscal/1.0</namespace>
   <remarks>
      <p>The OSCAL Control SSP format can be used to describe the information typically specified
			in a system security plan, such as those defined in SP 800-18 or used by FedRAMP.</p>
      <p>The root of the OSCAL System Security Plan (SSP) format is <code>system-security-plan</code>.</p>
      <p>NOTE: This documentation is a work in progress. As a result, documentation for many of the information elements is missing or incomplete.</p>
   </remarks>
   <!-- IMPORT STATEMENTS -->
   <import href="oscal_metadata_metaschema.xml"/>
   <import href="oscal_implementation-common_metaschema.xml"/>

   <!-- TOP LEVEL ASSEMBLY -->
   <define-assembly name="system-security-plan">
      <formal-name>System Security Plan (SSP)</formal-name>
      <description>TBD</description>
      <flag ref="id" required="yes"/>
      <model><!--
			<field named="title" required="yes"/>
			<field named="version" required="yes"/>
			<field named="date" required="yes"/>
			 -->
         <assembly ref="metadata"/>
         <assembly ref="import-profile" min-occurs="1"/>
         <assembly ref="system-characteristics">
            <group-as name="ssp-system-characteristics"/>
         </assembly>
         <assembly ref="system-implementation">
            <group-as name="ssp-system-implementation"/>
         </assembly>
         <assembly ref="control-implementation">
            <group-as name="ssp-control-implementation"/>
         </assembly>
         <assembly ref="back-matter"/>
      </model>
      <example/>
   </define-assembly>
   <!-- Profile Import -->
   <define-assembly name="import-profile">
      <formal-name>Import profile</formal-name>
      <description>Used to import the OSCAL profile representing the system's control baseline.</description>
      <flag ref="href" required="yes"/>
      <model>
         <field ref="remarks"/>
      </model>
   </define-assembly>

   <!-- SYSTEM CHARACTERISTICS -->
   <define-assembly name="system-characteristics">
      <formal-name>System Characteristics</formal-name>
      <description>Contains the characteristics of the system, such as its name, purpose, and
			security impact level.</description>
      <model>
         <field ref="system-id" min-occurs="1"/>
         <field ref="system-name" min-occurs="1"/>
         <field ref="system-name-short"/>
         <field ref="description" min-occurs="1">
            <description>A free-text description of the system.</description>
         </field>
         <field ref="security-sensitivity-level" min-occurs="1"/>
         <assembly ref="system-information" min-occurs="1">
            <group-as name="ssp-system-information"/>
         </assembly>
         <assembly ref="security-impact-level" min-occurs="1">
            <!-- TODO: Is this needed, or can it be computed based on the high water mark of the information types? -->
         </assembly>
         <assembly ref="security-eauth" min-occurs="1">
            <group-as name="security-eauths"/>
         </assembly>
         <assembly ref="status" min-occurs="1"/>
         <assembly ref="deployment-model"/>
         <assembly ref="service-model" max-occurs="unbounded">
            <group-as name="service-models"/>
         </assembly>
         <assembly ref="leveraged-authorization" max-occurs="unbounded">
            <description>All leveraged authorizations for this system.</description>
            <group-as name="leveraged-authorizations"/>
         </assembly>
         <assembly ref="authorization-boundary" min-occurs="1"/>
         <assembly ref="network-architecture">
            <group-as name="ssp-network-architecture"/>
         </assembly>
         <assembly ref="data-flow">
            <group-as name="ssp-data-flow"/>
         </assembly>
         <assembly ref="system-role" min-occurs="1" max-occurs="unbounded">
            <group-as name="system-roles" json-behavior="BY_KEY"/>
         </assembly>
      </model>
   </define-assembly>
   <define-field name="system-id" as-type="string">
      <formal-name>System Identification</formal-name>
      <description>TBD</description>
      <!-- TODO: What are the valid values? -->
      <flag ref="type"/>
   </define-field>
   <define-field name="system-name" as-type="string">
      <formal-name>System Name (Full)</formal-name>
      <description>TBD</description>
   </define-field>
   <define-field name="system-name-short" as-type="string">
      <formal-name>System Name (Short)</formal-name>
      <description>TBD</description>
   </define-field>

   <define-field name="security-sensitivity-level">
      <!-- TODO: Any constraints for the values? -->
      <formal-name>Security Sensitivity Level</formal-name>
      <description>TBD</description>
   </define-field>

   <define-flag name="impact-level" as-type="string">
      <formal-name>Impact level</formal-name>
      <description>TBD</description>
      <valid-values allow-other="yes">
         <value name="low">A 'low' sensitivity level such as what is defined in <a href="https://doi.org/10.6028/NIST.FIPS.199">FIPS-199</a>.</value>
         <value name="moderate">A 'moderate' sensitivity level such as what is defined in <a href="https://doi.org/10.6028/NIST.FIPS.199">FIPS-199</a>.</value>
         <value name="high">A 'high' sensitivity level such as what is defined in <a href="https://doi.org/10.6028/NIST.FIPS.199">FIPS-199</a>.</value>
      </valid-values>
   </define-flag>

   <define-assembly name="system-information">
      <formal-name>System Information</formal-name>
      <description>Contains details about all types of information stored, processed, or
			transmitted by the system, such as privacy information, and NIST 800-60 information
			types.</description>
      <model>
         <!-- TODO: Why is designation not a child of information type? -->
         <assembly ref="information-type" min-occurs="1" max-occurs="unbounded">
            <group-as name="ssp-information-type"/>
         </assembly>
         <assembly ref="designation" min-occurs="1" max-occurs="unbounded">
            <description>Used to enumerate all special information type designations that may be required by a specific organization or compliance regiem, such as privacy impact information (PII), or payment card information (PCI).</description>
            <group-as name="designations" json-behavior="SINGLETON_OR_ARRAY"/>
         </assembly>
      </model>
      <example/>
   </define-assembly>

   <define-assembly name="designation">
      <formal-name>System Information Designation</formal-name>
      <description>Used when a specific organization or compliance regiem requires certain information types to be explicitly cited, such as privacy impact information (PII), or payment card information (PCI).</description>
      <flag ref="name"/>
      <model>
         <!-- TODO: what are the following for? -->
         <field ref="title"/>
         <field ref="declaration"/>
         <assembly ref="qualifiers" max-occurs="unbounded">
            <group-as name="ssp-qualifiers"/>
         </assembly>
      </model>
      <example>
         <o:designation name="pii">
            <o:declaration>true</o:declaration>
         </o:designation>
         <o:designation name="pci">
            <o:declaration>false</o:declaration>
         </o:designation>
         <o:designation name="hipaa">
            <o:declaration>false</o:declaration>
         </o:designation>
         <o:designation name="sbu">
            <o:declaration>false</o:declaration>
         </o:designation>
      </example>
      <example>
         <designation xmlns="http://csrc.nist.gov/ns/oscal/example" id="pii">
            <title>A Privacy Sensitive System</title>
            <declaration>false</declaration>
         </designation>
      </example>
   </define-assembly>
   <define-field name="declaration" as-type="boolean">
      <formal-name>Declaration</formal-name>
      <description>Identifies whether a specific designation applies to this system.</description>
      <example>
         <designation xmlns="http://csrc.nist.gov/ns/oscal/example" id="pii">
            <title>A Privacy Sensitive System</title>
            <declaration>false</declaration>
         </designation>
      </example>
   </define-field>
   <define-assembly name="qualifiers">
      <formal-name>Information Designation Qualifiers</formal-name>
      <description>A list of questions about the system that contribute to the establishment of a designation, such as the FedRAMP privacy threshold analysis questions.</description>
      <model>
         <assembly ref="qualifier" max-occurs="unbounded">
            <group-as name="ssp-qualifiers"/>
         </assembly>
      </model>
      <example>
         <qualifiers xmlns="http://csrc.nist.gov/ns/oscal/example">
            <qualifier id="pta-01">
               <question>Does the ISA collect, maintain, or share PII in any identifiable form?</question>
               <response>no</response>
            </qualifier>
         </qualifiers>
      </example>
   </define-assembly>
   <define-assembly name="qualifier">
      <formal-name>Individual Information Designation Qualifier</formal-name>
      <description>An individual questions about the system that contributes to the establishment of a designation, such as a FedRAMP privacy threshold analysis question.</description>
      <flag ref="id"/>
      <model>
         <field ref="qual-question"/>
         <field ref="qual-response"/>
         <field ref="qual-notes"/>
      </model>
      <example>
         <qualifiers xmlns="http://csrc.nist.gov/ns/oscal/example">
            <qualifier id="pta-01">
               <qual-question>Is there a Privacy Act System of Records Notice (SORN) for this ISA system?</qual-question>
               <qual-response>yes</qual-response>
               <qual-notes>[SORN ID#]</qual-notes>
            </qualifier>
         </qualifiers>
      </example>
   </define-assembly>
   <define-field name="qual-question" as-type="string">
      <formal-name>Qualifier Question</formal-name>
      <description>A question that must be answered about this system.</description>
      <example>
         <qualifiers xmlns="http://csrc.nist.gov/ns/oscal/example">
            <qualifier id="pta-01">
               <qual-question>Is there a Privacy Act System of Records Notice (SORN) for this ISA system?</qual-question>
               <qual-response>yes</qual-response>
               <qual-notes>[SORN ID#]</qual-notes>
            </qualifier>
         </qualifiers>
      </example>
   </define-field>
   <define-field name="qual-response" as-type="string">
      <!-- TODO: yes/no is not a valid boolean value -->
      <formal-name>Qualifier Question Response</formal-name>
      <description>The response to the question.</description>
      <valid-values>
         <value name="yes">The answer is afirmative.</value>
         <value name="no">The answer is negative.</value>
      </valid-values>
      <example>
         <qualifiers xmlns="http://csrc.nist.gov/ns/oscal/example">
            <qualifier id="pta-01">
               <qual-question>Is there a Privacy Act System of Records Notice (SORN) for this ISA system?</qual-question>
               <qual-response>yes</qual-response>
               <qual-notes>[SORN ID#]</qual-notes>
            </qualifier>
         </qualifiers>
      </example>
   </define-field>
   <define-field name="qual-notes" as-type="string">
      <formal-name>Qualifier Question Response Notes</formal-name>
      <description>Additional information about the response to the question.</description>
      <example>
         <qualifiers xmlns="http://csrc.nist.gov/ns/oscal/example">
            <qualifier id="pta-01">
               <qual-question>Is there a Privacy Act System of Records Notice (SORN) for this ISA system?</qual-question>
               <qual-response>yes</qual-response>
               <qual-notes>[SORN ID#]</qual-notes>
            </qualifier>
         </qualifiers>
      </example>
   </define-field>
   <define-assembly name="information-type">
      <formal-name>Information Type</formal-name>
      <description>Contains details about one type of information stored, processed, or
			transmitted by the system, such as privacy information, and NIST 800-60 information
			types.</description>
      <flag ref="id"/>
      <flag ref="nist-id"/>
      <model>
         <field ref="description" min-occurs="1"/>
         <assembly ref="confidentiality-impact" min-occurs="1">
            <group-as name="ssp-confidentiality-impact"/>
         </assembly>
         <assembly ref="integrity-impact" min-occurs="1">
            <group-as name="ssp-integrity-impact"/>
         </assembly>
         <assembly ref="availability-impact" min-occurs="1">
            <group-as name="ssp-availability-impact"/>
         </assembly>
      </model>
   </define-assembly>
   <define-assembly name="confidentiality-impact">
      <formal-name>Confidentiality Impact Level</formal-name>
      <description>TBD</description>
      <model>
         <field ref="base" min-occurs="1"/>
         <field ref="selected"/>
         <field ref="adjustment-justification"/>
      </model>
      <example/>
   </define-assembly>
   <define-assembly name="integrity-impact">
      <formal-name>Integrity Impact Level</formal-name>
      <description>TBD</description>
      <model>
         <field ref="base" min-occurs="1"/>
         <field ref="selected"/>
         <field ref="adjustment-justification"/>
      </model>
      <example/>
   </define-assembly>
   <define-assembly name="availability-impact">
      <formal-name>Availability Impact Level</formal-name>
      <description>TBD</description>
      <model>
         <field ref="base" min-occurs="1"/>
         <field ref="selected"/>
         <field ref="adjustment-justification"/>
      </model>
      <example/>
   </define-assembly>
   <define-field name="base" as-type="empty">
      <formal-name>Base Level (Confidentiality, Integrity, or Availability)</formal-name>
      <description>The prescribed base (Confidentiality, Integrity, or Availability) security
			impact level.</description>
      <flag ref="impact-level"/>
   </define-field>
   <define-field name="selected" as-type="empty">
      <formal-name>Selected Level (Confidentiality, Integrity, or Availability)</formal-name>
      <description>The selected (Confidentiality, Integrity, or Availability) security impact
			level.</description>
   </define-field>
   <define-field name="adjustment-justification" as-type="markup-multiline">
      <formal-name>Adjustment Justification</formal-name>
      <description>If the selected security level is different from the base security level, this
			contains the justificaiton for the change.</description>
   </define-field>
   <define-assembly name="security-impact-level">
      <formal-name>Security Impact Level</formal-name>
      <description>TBD</description>
      <model>
         <field ref="security-objective-confidentiality"/>
         <field ref="security-objective-integrity"/>
         <field ref="security-objective-availability"/>
      </model>
      <example/>
   </define-assembly>
   <define-field name="security-objective-confidentiality" as-type="empty">
      <formal-name>Security Objective (Confidentiality)</formal-name>
      <description>TBD</description>
      <flag ref="impact-level"/>
   </define-field>
   <define-field name="security-objective-integrity" as-type="empty">
      <formal-name>Security Objective (Integrity)</formal-name>
      <description>TBD</description>
      <flag ref="impact-level"/>
   </define-field>
   <define-field name="security-objective-availability" as-type="empty">
      <formal-name>Security Objective (Availability)</formal-name>
      <description>TBD</description>
      <flag ref="impact-level"/>
   </define-field>
   <define-assembly name="security-eauth">
      <formal-name>Security Electronic Authentication Level</formal-name>
      <description>TBD</description>
      <model>
         <field ref="security-auth-ial"/>
         <field ref="security-auth-aal"/>
         <field ref="security-auth-fal"/>
         <field ref="security-eauth-level"/>
      </model>
      <example/>
   </define-assembly>
   <define-field name="security-auth-ial" as-type="string">
      <formal-name>Security Authentication (Identity Assurance Level)</formal-name>
      <description>TBD</description>
   </define-field>
   <define-field name="security-auth-aal" as-type="string">
      <formal-name>Security Authentication (Authenticator Assurance Level)</formal-name>
      <description>TBD</description>
   </define-field>
   <define-field name="security-auth-fal" as-type="string">
      <formal-name>Security Authentication (Federation Assurance Level)</formal-name>
      <description>TBD</description>
   </define-field>
   <define-field name="security-eauth-level" as-type="string">
      <formal-name>Security eAuthentication Level</formal-name>
      <description>TBD</description>
   </define-field>
   <define-assembly name="status">
      <formal-name>Status</formal-name>
      <description>TBD</description>
      <flag name="state" required="yes" as-type="string">
         <!-- TODO: FIX: This will not build if no datatype is provided -->
         <formal-name>State</formal-name>
         <description>TBD</description>
         <!-- TODO: valid values? 'other' might be a valid value, or should any other value be allowed -->
         <valid-values>
            <value name="operational">The system is currently operating and is in production.</value>
            <value name="under-development">The system is being designed, developed, or implemented</value>
            <value name="under-major-modification">The system is undergoing a major change, development, or transition.</value>
            <value name="disposition">The system is no longer operational.</value>
            <value name="other">Some other state.</value>
         </valid-values>
      </flag>
      <model>
         <field ref="remarks"/>
      </model>
      <remarks>
         <p>If 'other' is selected, a remark must be included to describe the current state.</p>
      </remarks>
   </define-assembly>
   <define-assembly name="deployment-model">
      <formal-name>Deployment Model</formal-name>
      <description>TBD</description>
      <flag name="type" required="yes">
         <formal-name></formal-name>
         <description>TBD</description>
         <!-- TODO: valid values? 'other' might be a valid value, or should any other value be allowed -->
         <valid-values>
            <value name="public"></value>
            <value name="private"></value>
            <value name="community"></value>
            <value name="government-only"></value>
            <value name="hybrid"></value>
            <value name="other">Some other deployment model.</value>
         </valid-values>
      </flag>
      <model>
         <field ref="remarks"/>
      </model>
      <remarks>
         <p>If 'other' is selected, a remark must be included to describe the type of deployment.</p>
      </remarks>
   </define-assembly>
   <define-assembly name="service-model">
      <formal-name>Service Model</formal-name>
      <description>TBD</description>
      <flag name="type" required="yes">
         <formal-name></formal-name>
         <description>TBD</description>
         <!-- TODO: valid values? 'other' might be a valid value, or should any other value be allowed -->
      </flag>
      <model>
         <field ref="remarks"/>
      </model>
      <remarks>
         <p>If 'other' is selected, a remark must be included to describe the type of deployment.</p>
      </remarks>
   </define-assembly>

   <define-assembly name="leveraged-authorization">
      <formal-name>Leveraged Authorization</formal-name>
      <description>The details for a single leveraged authorization</description>
      <flag ref="id"/>
      <model>
         <!-- TODO: Should this be able to reference another SSP? Is this the same as a common control? -->
         <field ref="leveraged-authorization-name" min-occurs="1"/>
         <field ref="leveraged-authorization-service-provider" min-occurs="1"/>
         <field ref="leveraged-authorization-date-granted" min-occurs="1"/>
      </model>
      <example/>
   </define-assembly>
   <define-field name="leveraged-authorization-name" as-type="string">
      <formal-name>Leveraged system Name</formal-name>
      <description>Name of the leveraged system.</description>
   </define-field>
   <define-field name="leveraged-authorization-service-provider" as-type="string">
      <formal-name>Leveraged System Service Provider Name</formal-name>
      <description>Name of the service provider that manages the leveraged system.</description>
      <!-- TODO: Should this map to a party by id? -->
   </define-field>
   <define-field name="leveraged-authorization-date-granted" as-type="date-with-timezone">
      <formal-name>Leveraged System Authorization Date</formal-name>
      <description>The date the leveraged system received its authorization.</description>
   </define-field>

   <define-assembly name="authorization-boundary">
      <formal-name>Authorization Boundary</formal-name>
      <description>TBD</description>
      <model>
         <field ref="description" min-occurs="1"/>
         <assembly ref="diagram" max-occurs="unbounded">
            <group-as name="diagrams" json-behavior="BY_KEY"/>
         </assembly>
         <field ref="remarks"/>
      </model>
      <example/>
   </define-assembly>

   <define-assembly name="diagram">
      <formal-name>Diagram</formal-name>
      <description>TBD</description>
      <json-key flag-name="id"/>
      <flag name="id" as-type="ID" required="yes">
         <formal-name>Diagram ID</formal-name>
         <description>An identifier for this diagram.</description>
      </flag>
      <flag ref="href" required="yes"/>
      <model>
         <field ref="description">
            <description>A description of the diagram (e.g., alternate text). this can be used to support compliance with requirements from Section 508 of the United States Workforce Rehabilitation Act of 1973.</description>
         </field>
      </model>
      <remarks>
         <p>The href references a remote URI or an internal reference within this document containing the diagram.</p>
      </remarks>
      <example>
         <o:diagram href="#attachmentA" id="boundary-diagram-1">
            <o:description>A boudnary diagram - bad example text.</o:description>
         </o:diagram>
      </example>
   </define-assembly>
   <define-assembly name="network-architecture">
      <formal-name>Network Architecture Diagrams</formal-name>
      <description>TBD</description>
      <model>
         <field ref="description" min-occurs="1"/>
         <assembly ref="diagram" max-occurs="unbounded">
            <group-as name="diagrams" json-behavior="BY_KEY"/>
         </assembly>
         <field ref="remarks"/>
      </model>
      <example/>
   </define-assembly>
   <define-assembly name="data-flow">
      <!-- TODO: Should this relate to a system-interconnection? -->
      <formal-name>Data Flow</formal-name>
      <description>TBD</description>
      <model>
         <field ref="description" min-occurs="1"/>
         <assembly ref="diagram" max-occurs="unbounded">
            <group-as name="diagrams" json-behavior="BY_KEY"/>
         </assembly>
         <field ref="remarks"/>
      </model>
      <example/>
   </define-assembly>
   <define-assembly name="system-role">
      <!-- **** Need to ensure <users> </users> matches pocs, roles, orgs **** -->
      <formal-name>Role</formal-name>
      <description>Defining a role to be assigned to a party or agent</description>
      <json-key flag-name="id"/>
      <flag name="id" as-type="ID" required="yes">
         <formal-name>System Role ID</formal-name>
         <description>TBD</description>
      </flag>
      <flag ref="role-id" required="yes"/>
      <flag ref="name" required="yes"/>
      <!-- TODO: provide valid values for these? -->
      <flag ref="external" required="yes"/>
      <flag ref="access" required="yes"/>
      <flag ref="sensitivity-level" required="yes"/>
      <model>
         <field ref="title"/>
         <field ref="short-name"/>
         <field ref="description"/>
         <!-- The following fields appear in <users><roles>, but not in <metadata><roles> -->
         <field ref="privilege" max-occurs="unbounded">
            <group-as name="privileges"/>
         </field>
         <field ref="responsibility" max-occurs="unbounded">
            <group-as name="responsibilities"/>
         </field>
         <assembly ref="statistics" min-occurs="1"/>
      </model>
      <remarks>
         <p>Permissible values to be determined closer to the application (e.g. by a receiving
            authority).</p>
      </remarks>
   </define-assembly>
   <define-field name="privilege" as-type="string">
      <formal-name>Privilege</formal-name>
      <description>Identifies the type/level of system privilege for the role.
			For FedRAMP, the only valid values are "p" (Privileged), "np" (Non-Privileged), or "nla" (No Logical Access).</description>
   </define-field>
   <define-field name="responsibility" as-type="string">
      <formal-name>Responsibility</formal-name>
      <description>Identifies the functions performed by the user role.</description>
   </define-field>
   <define-assembly name="statistics">
      <formal-name>Statistics</formal-name>
      <description>Provides a collection of statistics about users of the system.</description>
      <model>
         <field ref="internal-user-total-current"/>
         <field ref="internal-user-total-future"/>
         <field ref="external-user-total-current"/>
         <field ref="external-user-total-future"/>
      </model>
      <example/>
   </define-assembly>
   <define-field name="internal-user-total-current" as-type="positiveInteger">
      <formal-name>Total Current Internal Users</formal-name>
      <description>TBD</description>
      <remarks>
         <p>To be validated as a natural number (integer &gt;= 1)</p>
      </remarks>
   </define-field>
   <define-field name="internal-user-total-future" as-type="positiveInteger">
      <formal-name>Total Future Internal Users</formal-name>
      <description>TBD</description>
      <remarks>
         <p>To be validated as a natural number (integer &gt;= 1)</p>
      </remarks>
   </define-field>
   <define-field name="external-user-total-current" as-type="positiveInteger">
      <formal-name>Total Current External Users</formal-name>
      <description>TBD</description>
      <remarks>
         <p>To be validated as a natural number (integer &gt;= 1)</p>
      </remarks>
   </define-field>
   <define-field name="external-user-total-future" as-type="positiveInteger">
      <formal-name>Total Future External Users</formal-name>
      <description>TBD</description>
      <remarks>
         <p>To be validated as a natural number (integer &gt;= 1)</p>
      </remarks>
   </define-field>

   <!-- SYSTEM IMPLEMENTATION -->
   <define-assembly name="system-implementation">
      <formal-name>System Implementation</formal-name>
      <description>Provides information as to how the system is implemented.</description>
      <model>
         <assembly ref="component" max-occurs="unbounded">
            <group-as name="components" json-behavior="BY_KEY"/>
         </assembly>
         <assembly ref="capability" max-occurs="unbounded">
            <group-as name="capabilities" json-behavior="BY_KEY"/>
         </assembly>
         <assembly ref="service" max-occurs="unbounded">
            <description>A collection of the ports, protocols, and services used within the
               system.</description>
            <group-as name="services"/>
         </assembly>
         <assembly ref="interconnection" max-occurs="unbounded">
            <group-as name="ssp-interconnection"/>
         </assembly>
         <assembly ref="system-inventory"/>
      </model>
      <example/>
   </define-assembly>
   <define-assembly name="component">
      <formal-name>Component</formal-name>
      <description>A defined component that can be part of an implemented system.</description>
      <json-key flag-name="id"/>
      <flag name="id" as-type="ID" required="true">
         <formal-name>Component Identifier</formal-name>
         <description>A unique identifier for a component.</description>
      </flag>
      <flag name="name" as-type="string" required="true">
         <formal-name>Component Name</formal-name>
         <description>The component's human-readable name.</description>
      </flag>
      <flag ref="component-type"/>
      <model>
         <field ref="description" min-occurs="1"/>
         <field ref="prop" max-occurs="unbounded">
            <group-as name="properties"/>
            <flag ref="name">
               <valid-values allow-other="yes">
                  <value name="version">The version of the component.</value>
                  <value name="model">The model of the component.</value>
                  <value name="release-date">The date the component was released.</value>
               </valid-values>
            </flag>
         </field>
         <field ref="link" max-occurs="unbounded">
            <group-as name="links"/>
            <flag ref="rel">
               <valid-values allow-other="yes">
                  <value name="depends-on">A reference to another component that this component has a dependency on.</value>
                  <value name="validated-by">A reference to another component of type=validation, that is a validation (e.g., FIPS 140-2) for this component</value>
                  <value name="proof-of-compliance">A pointer to a validation record (e.g., FIPS 140-2) or other authorization.</value>
               </valid-values>
            </flag>
         </field>
         <assembly ref="supplier" min-occurs="1"/>
<!--         <assembly ref="proof-of-compliance" max-occurs="unbounded">
            <group-as name="proofs-of-compliance" />
         </assembly>
--><!--         <assembly ref="control-implementation" max-occurs="unbounded">
            <!-\- TODO; figure out if this should be here or later -\->
            <group-as name="control-implementations" />
         </assembly>
-->         <assembly ref="configuration" max-occurs="unbounded">
            <group-as name="configurations" json-behavior="BY_KEY" />
         </assembly>
         <assembly ref="artifact" max-occurs="unbounded">
            <group-as name="artifacts" json-behavior="BY_KEY" />
         </assembly>
         <field ref="remarks"/>
      </model>
      <remarks>
         <p>Components may be products, services, APIs, policies, processes, plans, guidance,
            standards, or other tangible items that enable security and/or privacy.</p>
         <p>The <code>type</code> indicates which of these component types is represented.</p>
         <p>A group of components may be aggregated into a <code>capability</code>. For example, am account management capability that consists of an account management process, and a Lightweight Directory Access Protocol (LDAP) software implementation.</p>
         <p>Capabilities are expressed by combining one or more components.</p>
      </remarks>
   </define-assembly>

   <define-assembly name="capability">
      <formal-name>Capability</formal-name>
      <description>A grouping of other components and/or capabilities.</description>
      <json-key flag-name="id"/>
      <flag name="id" as-type="ID" required="true">
         <formal-name>Capability Identifier</formal-name>
         <description>A unique identifier for a capability.</description>
      </flag>
      <flag name="name" as-type="string" required="true">
         <formal-name>Capability Name</formal-name>
         <description>The capability's human-readable name.</description>
      </flag>
      <model>
         <field ref="description" min-occurs="1"/>
         <field ref="prop" max-occurs="unbounded">
            <group-as name="properties"/>
         </field>
         <field ref="link" max-occurs="unbounded">
            <group-as name="links"/>
            <!-- TODO: Model specific link relationships for:
          depends-on: component has a dependency on another component
          validated-by:, etc.
        -->
         </field>
         <assembly ref="incorporates-capability" max-occurs="unbounded">
            <group-as name="incorporates-capabilities" json-behavior="BY_KEY"/>
         </assembly>
         <assembly ref="incorporates-component" max-occurs="unbounded">
            <group-as name="incorporates-components" json-behavior="BY_KEY"/>
         </assembly>
<!--         <assembly ref="control-implementation" max-occurs="unbounded">
            <group-as name="control-implementations" />
         </assembly>
-->         <field ref="remarks"/>
      </model>
   </define-assembly>

   <define-assembly name="service">
      <formal-name>Service</formal-name>
      <description>Information about an individual service within the
			system.</description>
      <flag ref="id"/>
      <flag ref="name"/>
      <model>
         <assembly ref="protocol" max-occurs="unbounded">
            <group-as name="ssp-protocol"/>
         </assembly>
         <field ref="purpose"/>
         <assembly ref="used-by-component" max-occurs="unbounded">
            <group-as name="used-by-components" json-behavior="SINGLETON_OR_ARRAY"/>
         </assembly>
      </model>
      <example/>
   </define-assembly>
   <define-assembly name="protocol">
      <formal-name>Protocol</formal-name>
      <description>Information about the protocol used to provide a service.</description>
      <flag ref="name"/>
      <model>
         <field ref="port-range" max-occurs="unbounded">
            <group-as name="port-ranges"/>
         </field>
      </model>
      <example/>
   </define-assembly>
   <define-field name="port-range">
      <formal-name>Port Range</formal-name>
      <description>TBD</description>
      <flag ref="start"/>
      <flag ref="end"/>
      <flag ref="transport"/>
      <remarks>
         <p>To be validated as a natural number (integer &gt;= 1)</p>
      </remarks>
   </define-field>
   <define-field name="purpose" as-type="markup-line">
      <formal-name>Purpose</formal-name>
      <description>Describes the purpose for the service within the system.</description>
   </define-field>
   <define-assembly name="used-by-component">
      <formal-name>Used By</formal-name>
      <description>Identifies a type of uses for the service. A component can be optionally identified.</description>
      <flag ref="component-id"/>
      <model>
         <field ref="description" min-occurs="1"/>
      </model>
   </define-assembly>
   <define-assembly name="interconnection">
      <!-- TODO: provide a mechanism to reference another OSCAL SSP or other documentation. -->
      <!-- TODO: provide a mechanism to reference the ISA. -->
      <formal-name>Interconnection</formal-name>
      <description>Details on an individual system interconnection.</description>
      <flag ref="id"/>
      <model>
         <field ref="external-system-name"/>
         <field ref="external-system-org"/>
         <field ref="isa-authorization" max-occurs="unbounded">
            <group-as name="isa-authorizations"/>
         </field>
         <field ref="isa-name"/>
         <field ref="isa-date"/>
      </model>
      <remarks>
         <p>If there is at least one interconnecton element, the system-interconnections element
				should be "yes".</p>
      </remarks>
      <example/>
   </define-assembly>
   <define-field name="external-system-name" as-type="string">
      <formal-name>External System Name</formal-name>
      <description>TBD</description>
   </define-field>
   <define-field name="external-system-org" as-type="string">
      <formal-name>External System Organization</formal-name>
      <description>TBD</description>
   </define-field>
   <define-field name="isa-authorization">
      <formal-name>ISA Authorization</formal-name>
      <description>Name of the individual who authorized the Interconnection Security Agreement
			(ISA).</description>
   </define-field>
   <define-field name="isa-name" as-type="string">
      <formal-name>ISA Name</formal-name>
      <description>Title of the Interconnection Security Agreement (ISA).</description>
   </define-field>
   <define-field name="isa-date" as-type="string">
      <formal-name>ISA Date</formal-name>
      <description>Date of the Interconnection Security Agreement (ISA).</description>
   </define-field>
   <define-field name="vendor" as-type="string">
      <formal-name>Vendor</formal-name>
      <description>TBD</description>
      <flag ref="id"/>
      <flag ref="type"/>
   </define-field>
<!--
   <define-assembly name="characteristics">
      <formal-name>Characteristics</formal-name>
      <description>Component characteristics, assets and configuration information</description>
      <flag ref="context"/>
      <model>
         <field ref="ip-address" max-occurs="unbounded">
            <group-as name="ip-addresses"/>
         </field>
         <assembly ref="service" max-occurs="unbounded">
            <group-as name="ssp-service"/>
         </assembly>
         <field ref="prose"/>
      </model>
      <remarks>
         <p>When context="specification", this describes all security relevant settings in the
        component.</p>
         <p>When context="standard", this describes how to configure the component to meet a
        specific goal, such as compliance with FISMA Moderate, PCI, or GPRD.</p>
         <p>When context="actual", or when no type is listed, this describes the actual
        configuration of the component within a specific system.</p>
      </remarks>
      <example/>
   </define-assembly>
   <define-assembly name="satisfaction">
      <formal-name>Satisfaction</formal-name>
      <description>Describes how the indicated control is satisfied by this
      component</description>
      <flag ref="id" as-type="ID"/>
      <flag ref="context"/>
      <model>
         <field ref="prose"/>
      </model>
      <remarks>
         <p>When context="specification", this describes how the control could be satisfied by
        the component.</p>
         <p>When context="standard", this describes how the security control would be satisfied
        if the component was configured in accordance with the associated characteristics
        provisioning information.</p>
         <p>When context="actual", or when no type is listed, this describes how the control is
        satisfied based on the component's actual deployment within a given system.</p>
      </remarks>
   </define-assembly>
-->
   <define-field name="ip-address" as-type="string">
      <formal-name>Internet Protocol Address</formal-name>
      <description>Use the @type flag to deisgnate IPv4 or IPv6.</description>
      <flag ref="type"/>
   </define-field>
   <define-assembly name="system-inventory">
      <formal-name>System Inventory</formal-name>
      <description>TBD</description>
      <model>
         <assembly ref="inventory-item" min-occurs="1" max-occurs="unbounded">
            <group-as name="inventory-items"/>
         </assembly>
      </model>
      <example/>
   </define-assembly>
   <define-assembly name="inventory-item">
      <formal-name>Inventory Item</formal-name>
      <description>TBD</description>
      <flag ref="id"/>
      <flag ref="component-id"/>
      <flag ref="virtual"/>
      <flag ref="public"/>
      <model>
         <field ref="ip-address" max-occurs="unbounded">
            <group-as name="ip-addresses"/>
         </field>
         <field ref="dns-name" max-occurs="unbounded">
            <group-as name="dns-names"/>
         </field>
         <assembly ref="host-item" max-occurs="unbounded">
            <group-as name="ssp-host-item"/>
         </assembly>
         <assembly ref="software-item" max-occurs="unbounded">
            <group-as name="ssp-software-item"/>
         </assembly>
         <field ref="comments"/>
         <field ref="serial-no"/>
         <field ref="network-id" max-occurs="unbounded">
            <group-as name="network-ids"/>
         </field>
         <!-- TODO: use a role reference? -->
         <field ref="asset-owner" max-occurs="unbounded">
            <group-as name="asset-owners"/>
         </field>
         <!-- TODO: use a role reference? -->
         <field ref="asset-administrator" max-occurs="unbounded">
            <group-as name="asset-administrators"/>
         </field>
      </model>
      <example/>
   </define-assembly>
   <define-field name="dns-name" as-type="string">
      <formal-name>Network Name</formal-name>
      <description>If available, state the DNS name or URL of the inventory item. This can be left
			blank if one does not exist, or it is a dynamic field.</description>
   </define-field>
   <define-assembly name="host-item">
      <formal-name>Host Item</formal-name>
      <description>TBD</description>
      <model>
         <!-- TODO: replace these with properties? -->
         <field ref="netbios-name" max-occurs="unbounded">
            <group-as name="netbios-names"/>
         </field>
         <field ref="mac-address" max-occurs="unbounded">
            <group-as name="mac-addresses"/>
         </field>
         <field ref="authenticated-scan" max-occurs="unbounded">
            <group-as name="authenticated-scans"/>
         </field>
         <field ref="baseline-template" max-occurs="unbounded">
            <group-as name="baseline-templates"/>
         </field>
         <field ref="os-name" max-occurs="unbounded">
            <group-as name="os-names"/>
         </field>
         <field ref="os-version" max-occurs="unbounded">
            <group-as name="os-versions"/>
         </field>
         <field ref="location" max-occurs="unbounded">
            <group-as name="locations"/>
         </field>
         <field ref="asset-type" max-occurs="unbounded">
            <group-as name="asset-types"/>
         </field>
         <!-- TODO: use supplier? -->
         <field ref="vendor" max-occurs="unbounded">
            <group-as name="vendors"/>
         </field>
         <field ref="hardware-model" max-occurs="unbounded">
            <group-as name="hardware-models"/>
         </field>
         <field ref="scanned" max-occurs="unbounded">
            <group-as name="ssp-scanned"/>
         </field>
         <field ref="prop" max-occurs="unbounded">
            <group-as name="properties"/>
         </field>
      </model>
      <remarks>
         <p>Required for physical or virtual machines, network components, and similar
				objects.</p>
      </remarks>
      <example/>
   </define-assembly>
   <define-field name="netbios-name">
      <formal-name>NetBIOS Name</formal-name>
      <description>If available, state the NetBIOS name of the inventory item. This can be omitted
			if one does not exist, or it is a dynamic field.</description>
   </define-field>
   <define-field name="mac-address" as-type="string">
      <formal-name>Media Access Control (MAC) Address</formal-name>
      <description>If available, state the MAC Address of the inventory item. This can be left
			blank if one does not exist, or it is a dynamic field.</description>
   </define-field>
   <define-field name="os-name" as-type="string">
      <formal-name>Operating System Name</formal-name>
      <description>TBD</description>
      <remarks>
         <p>If the @component-id flag is provided in the inventory-item element, this can be
				derived from the component information.</p>
      </remarks>
   </define-field>
   <define-field name="os-version" as-type="string">
      <formal-name>Operating System Version Number</formal-name>
      <description>TBD</description>
      <remarks>
         <p>If the @component-id flag is provided in the inventory-item element, this can be
				derived from the component information.</p>
      </remarks>
   </define-field>
   <define-field name="location">
      <formal-name>Location of the Asset</formal-name>
      <description>Physical location of hardware. Could include Data Center ID, Cage#, Rack# or
			other meaningful location identifiers.</description>
   </define-field>
   <define-field name="asset-type" as-type="string">
      <formal-name>Asset Type</formal-name>
      <description>Simple description of the asset's function (e.g., Router, Storage Array, DNS
			Server, etc.) Do not use vendor or product names here.</description>
   </define-field>
   <define-field name="hardware-model" as-type="string">
      <formal-name>Hardware Model</formal-name>
      <description>Model number of the hardware.</description>
      <remarks>
         <p>If the @component-id flag is provided in the inventory-item element, this can be
				derived from the component information.</p>
      </remarks>
   </define-field>
   <define-field name="authenticated-scan" as-type="boolean">
      <formal-name>Authenticated Scan</formal-name>
      <description>Indicate whether this asset is planned for authenticated
			scanning.</description>
   </define-field>
   <define-assembly name="software-item">
      <formal-name>Software Item</formal-name>
      <description>TBD</description>
      <model>
         <!-- TODO: replace these with properties? -->
         <field ref="vendor" max-occurs="unbounded">
            <group-as name="vendors"/>
         </field>
         <field ref="software-name" max-occurs="unbounded">
            <group-as name="software-names"/>
         </field>
         <field ref="software-version" max-occurs="unbounded">
            <group-as name="software-versions"/>
         </field>
         <field ref="software-patch-level" max-occurs="unbounded">
            <group-as name="software-patch-levels"/>
         </field>
         <field ref="function" max-occurs="unbounded">
            <group-as name="functions"/>
         </field>
      </model>
      <remarks>
         <p>Required for software that runs on a host-item, such as a web server or database application.</p>
      </remarks>
      <example/>
   </define-assembly>
   <define-field name="software-name" as-type="string">
      <formal-name>Software Product Name</formal-name>
      <description>TBD</description>
      <remarks>
         <p>If the @component-id flag is provided in the inventory-item element, this can be
				derived from the component information.</p>
      </remarks>
   </define-field>
   <define-field name="software-version" as-type="string">
      <formal-name>Software Version Number</formal-name>
      <description>TBD</description>
      <remarks>
         <p>If the @component-id flag is provided in the inventory-item element, this can be
				derived from the component information.</p>
      </remarks>
   </define-field>
   <define-field name="software-patch-level" as-type="string">
      <formal-name>Software Patch Level (If applicable)</formal-name>
      <description>TBD</description>
      <remarks>
         <p>If the @component-id flag is provided in the inventory-item element, this can be
				derived from the component information.</p>
      </remarks>
   </define-field>
   <define-field name="function" as-type="string">
      <formal-name>Function</formal-name>
      <description>TBD</description>
      <remarks>
         <p>If the @component-id flag is provided in the inventory-item element, this can be
				derived from the component information.</p>
      </remarks>
   </define-field>
   <define-field name="comments" as-type="string">
      <formal-name>Comments</formal-name>
      <description>Any additional information that could be useful to an auditor or
			reviewer.</description>
   </define-field>
   <define-field name="serial-no" as-type="string">
      <formal-name>Serial Number</formal-name>
      <description>Product serial number or internal asset tag number.</description>
   </define-field>
   <define-field name="network-id" as-type="string">
      <formal-name>Network ID</formal-name>
      <description>Virtual LAN or Network ID.</description>
   </define-field>
   <define-field name="asset-owner" as-type="string">
      <formal-name>Asset Owner</formal-name>
      <description>The individual, title, or role who "owns" the asset on behalf of the
			organization.</description>
      <flag ref="party-id"/>
   </define-field>
   <define-field name="asset-administrator" as-type="string">
      <formal-name>Asset Administrator</formal-name>
      <description>The individual, title, role, or team responsible for operating and maintaining
			the asset.</description>
      <flag ref="party-id"/>
   </define-field>


   <define-assembly name="control-implementation">
      <formal-name>Control Implementation</formal-name>
      <description>Defines how the system (as a whole) supports a set of controls.</description>
      <model>
         <field ref="description" min-occurs="1"/>
         <assembly ref="meets-requirement-set" max-occurs="unbounded">
            <group-as name="meets-requirement-sets"/>
         </assembly>
         <assembly ref="by-component" max-occurs="unbounded">
            <group-as name="by-components"/>
         </assembly>
         <assembly ref="by-capability" max-occurs="unbounded">
            <group-as name="by-capabilities"/>
         </assembly>
      </model>
   </define-assembly>

   <define-assembly name="by-component">
      <formal-name>Component Control Implementation</formal-name>
      <description>Defines how the referenced component implements a set of controls.</description>
      <flag ref="component-id" required="yes"/>
      <model>
         <field ref="description" min-occurs="1"/>
         <assembly ref="meets-requirement-set" max-occurs="unbounded">
            <group-as name="meets-requirement-sets"/>
         </assembly>
      </model>
   </define-assembly>

   <define-assembly name="by-capability">
      <formal-name>capability Control Implementation</formal-name>
      <description>Defines how the referenced capability implements a set of controls.</description>
      <flag ref="capability-id" required="yes"/>
      <model>
         <field ref="description" min-occurs="1"/>
         <assembly ref="meets-requirement-set" max-occurs="unbounded">
            <group-as name="meets-requirement-sets"/>
         </assembly>
      </model>
   </define-assembly>

   <define-assembly name="meets-requirement-set">
      <formal-name>Meets</formal-name>
      <description>Defines what sets of controls are supported by the system (as a whole).</description>
      <model>
         <field ref="responsible-role" max-occurs="unbounded">
            <group-as name="ssp-responsible-role"/>
         </field>
         <assembly ref="set-param" max-occurs="unbounded">
            <group-as name="parameter-settings"/>
         </assembly>
         <field ref="description" min-occurs="1"/>
         <field ref="prop" max-occurs="unbounded">
            <group-as name="properties"/>
         </field>
         <field ref="link" max-occurs="unbounded">
            <group-as name="links"/>
            <!-- TODO: Model specific link relationships -->
         </field>
         <assembly ref="implemented-requirement" min-occurs="1" max-occurs="unbounded">
            <group-as name="implemented-requirements"/>
         </assembly>
      </model>
   </define-assembly>










   <define-field name="responsible-role" as-type="empty">
      <formal-name>Responsible Role</formal-name>
      <description>TBD</description>
      <flag ref="role-id" required="yes"/>
   </define-field>
   <define-assembly name="set-param">
      <formal-name>Set Parameter Value</formal-name>
      <description>Identifies the parameter that will be filled in by the enclosed value
			element.</description>
      <flag ref="param-id" required="yes"/>
<!--      <flag ref="target" as-type="string"/>
-->      <model>
         <field ref="value"/>
      </model>
      <example/>
   </define-assembly>
   <define-field name="value" as-type="string">
      <formal-name>Value</formal-name>
      <description>The phrase or string that fills-in the parameter and completes the requirement
			statement.</description>
   </define-field>
   <!-- ===== FLAGS ===== -->
<!--   <define-flag name="component-id" as-type="NCName">
      <formal-name>Component ID / identifier</formal-name>
      <description>ID of a linked or imported component</description>
      <remarks>
         <p>In the context of an import statement, this identifies the id of a component to
				import, and is required.</p>
         <p>In the context of an inventory item, this identifies a component related to the
				inventory item, and is optional.</p>
         <p>A component, such as a web server, may be duplicated within the system, such as a
				cluster of web servers.</p>
         <p>The web server component is defined once, but each instance of the web server must be
				listed in the inventory. Each instance points to the same web server component.</p>
      </remarks>
      <example>
         <import xmlns="http://csrc.nist.gov/ns/oscal/example"
                 href="../vendor/components/component_file.xml">
            <include>
               <call component-id="comp02"/>
            </include>
         </import>
      </example>
   </define-flag>
-->
<!--   <define-flag name="control-id" as-type="NCName">
      <formal-name>Control ID / identifier</formal-name>
      <description>Pointer to a control, by its ID</description>
      <remarks>
         <p>May also address subcontrols.</p>
      </remarks>
   </define-flag>
-->
   <define-flag name="nist-id" as-type="string">
      <formal-name>NIST 800-60 Information Type Identifier</formal-name>
      <description>Pointer to the information type in NIST SP 800-60.</description>
   </define-flag>
<!--   <define-flag name="poc-id" as-type="NCName">
      <formal-name>Point of Contact ID / identifier</formal-name>
      <description>Identifies the unique identifier for an individual, title, role, or
			team.</description>
      <example>
         <asset-owner xmlns="http://csrc.nist.gov/ns/oscal/example" poc-id="xyz2"/>
      </example>
   </define-flag>
-->
   <define-flag name="param-id" as-type="NCName">
      <formal-name>Parameter ID</formal-name>
      <description>Points to a parameter within a control, to which the contained value will be
			assigned.</description>
      <example>
         <set-param xmlns="http://csrc.nist.gov/ns/oscal/example" param-id="ac-2_prm_2">
            <value>System ISSO</value>
         </set-param>
      </example>
   </define-flag>
<!--   <define-flag name="target" as-type="string">
      <formal-name>Target label</formal-name>
      <description>Provides for an indication of a link target, by its label, when no ID is available</description>
   </define-flag>
   <define-flag name="filename" as-type="string">
      <formal-name>File Name</formal-name>
      <description>Name of the file before it was converted to Base-64. This is the name that will be assigned to the file when converted back to binary.</description>
   </define-flag>
   <define-flag name="role-id" as-type="NCName">
      <formal-name>Role ID</formal-name>
      <description>In the context of a responsibility element, this points to a role in the users element responsible for this control</description>
      <example>
         <group xmlns="http://csrc.nist.gov/ns/oscal/example" class="family" id="ac">
            <implementation class="SP800-53 control" control-id="ac-2">
               <responsibility role-id="isso"/>
               <responsibility role-id="cloud_system_manager"/>
               <responsibility role-id="hr"/>
            </implementation>
         </group>
      </example>
   </define-flag>
-->   <!--<define-flag name="target" datatype="NMTOKEN" show-docs="xml json">
		<formal-name>Target Control ID</formal-name>
		<description>Identifies the control answered by this response statement.</description>
		<remarks>
			<p>I'd like to call this control-id or subcontrol-id - wap</p>
		</remarks>
		<example>
			<response xmlns="http://csrc.nist.gov/ns/oscal/example" target="ac-2_smt.g">Response to AC-2 part
				g.</response>
		</example>
	</define-flag>-->
<!--   <define-flag name="class" as-type="NCName">
      <formal-name>Class</formal-name>
      <description>Identifies the property or object within the control; a semantic hint</description>
      <remarks>
         <p>Overloading this attribute with more than one value is permitted, but not recommended.</p>
      </remarks>
   </define-flag>
--><!--   <define-flag name="context" as-type="string">
      <formal-name>Context</formal-name>
      <description>Context designates the context of information provided.</description>
      <remarks>
         <p>The @context flag indicates the component's "characteristics" and "satisfaction"
				elements.</p>
      </remarks>
      <example/>
   </define-flag>
-->
<!--   <define-flag name="name" as-type="string">
      <formal-name>Name</formal-name>
      <description>Name allows the information to be named.</description>
      <remarks>
         <p>For service information, this is the name of the service.</p>
      </remarks>
      <example/>
   </define-flag>
-->
   <define-flag name="start" as-type="nonNegativeInteger">
      <formal-name>Start</formal-name>
      <description>Indicates the starting port number in a port range.</description>
      <remarks>
         <p>Should be a number within a permitted range</p>
      </remarks>
      <example>
         <service xmlns="http://csrc.nist.gov/ns/oscal/example"
                  id="svc-01"
                  name="Domain Name Service (DNS) Lookup">
            <protocol name="dns">
               <port-range start="53" end="53" transport="tcp"/>
            </protocol>
         </service>
      </example>
   </define-flag>
   <define-flag name="end" as-type="nonNegativeInteger">
      <formal-name>End</formal-name>
      <description>Indicates the ending port number in a port range.</description>
      <remarks>
         <p>Should be a number within a permitted range</p>
      </remarks>
      <example>
         <service xmlns="http://csrc.nist.gov/ns/oscal/example"
                  id="svc-01"
                  name="Domain Name Service (DNS) Lookup">
            <protocol name="dns">
               <port-range start="53" end="53" transport="tcp"/>
            </protocol>
         </service>
      </example>
   </define-flag>
   <define-flag name="transport" as-type="string">
      <formal-name>Transport</formal-name>
      <description>Indicates the transport type.</description>
      <example>
         <service xmlns="http://csrc.nist.gov/ns/oscal/example"
                  id="svc-01"
                  name="Domain Name Service (DNS) Lookup">
            <protocol name="dns">
               <port-range start="53" end="53" transport="tcp"/>
            </protocol>
         </service>
      </example>
   </define-flag>
<!--   <define-flag name="type" as-type="string">
      <formal-name>Type</formal-name>
      <description>Type designates the type of information provided.</description>
      <remarks>
         <p>For information system ID, the @type flag indicates the organizaiton who issue the
				identifier.</p>
         <p>For vendor, the @type flag indicates the type of ID provided in the @id flag, such as
				a DUNS, CAGE, or similar.</p>
         <p>For ip-address, the @type flag indicates either "ipv4" or "ipv6".</p>
      </remarks>
      <example/>
   </define-flag>
-->   <define-flag name="public" as-type="boolean">
      <formal-name>Public</formal-name>
      <description>Designates an asset as either publicly accessible (="yes") or not
			(="no").</description>
      <example/>
   </define-flag>
   <define-flag name="virtual" as-type="boolean">
      <formal-name>Virtual</formal-name>
      <description>Designates an asset as either virtual (="yes") or physical
			(="no").</description>
      <example/>
   </define-flag>
   <define-flag name="external" as-type="boolean">
      <formal-name>external</formal-name>
      <description>TBD</description>
   </define-flag>
   <define-flag name="access" as-type="string">
      <formal-name>access</formal-name>
      <description>TBD</description>
   </define-flag>
   <define-flag name="sensitivity-level" as-type="string">
      <formal-name>sensitivity-level</formal-name>
      <description>TBD</description>
   </define-flag>
<!--   <define-field name="organization">
      <formal-name>organization</formal-name>
      <description>TBD</description>
   </define-field>
-->   <define-field name="baseline-template">
      <formal-name>baseline-template</formal-name>
      <description>TBD</description>
   </define-field>
   <define-field name="scanned">
      <formal-name>scanned</formal-name>
      <description>TBD</description>
   </define-field>
   <!--      IMPORTED METASCHEMA      -->
   <!-- The following was copied in for now, and should later be
	referenced in its original location.
	DO NOT MAKE CHANGES IN THE TEXT BELOW THIS COMMENT
	IT WILL BE DELETED (REPLACED WITH REFERENCES) AND LOST.
-->
   <!--  <define-assembly name="metadata">
    <formal-name>Publication metadata</formal-name>
    <description>Information describing the publication or availability of this document</description>
    <model>
      <field      named="title"    required="yes"/>
      <fields     named="author"/>
      <field      named="publication-date"/>
      <field      named="version"/>
      <fields     named="doc-id"/>
      <fields     named="prop"/>
      <assemblies named="hlink"/>
      <assemblies named="resource"/>
      <assemblies named="role"/>
      <assemblies named="party"/>
      <assembly   named="notes"/>
      <assembly   named="extra-meta"/>
    </model>
  </define-assembly>

  <define-field name="title">
    <formal-name>Title</formal-name>
    <description>The title under which this document is formally published</description>
  </define-field>

  <define-field name="author" group-as="authors">
    <formal-name>Author</formal-name>
    <description>A named author</description>
    <remarks><p>Note this information may be duplicative of information given in a <code>party</code>
    element with appropriate <code>role-id</code> flags, along with more a more complete structured
    listing. This element provides a value for display as well as an additional point of comparison.</p></remarks>
  </define-field>


  <define-field name="publication-date">
    <formal-name>Publication date</formal-name>
    <description>The official date of publication</description>
  </define-field>

  <define-field name="version">
    <flag name="iso-date"/>
    <formal-name>version</formal-name>
    <description>Version information</description>
  </define-field>

  <define-flag name="iso-date" datatype="date">
    <formal-name>ISO (standard) date</formal-name>
    <description>Please use YYYY-MM-DD syntax.</description>
    <remarks>
      <p>The syntax may be validated in back. The date given should presumably be the same as the
        (human-readable) <code>date</code> given above it (and such a discrepancy is also be
        detectable).</p>
    </remarks>
  </define-flag>

  <define-field name="doc-id" group-as="document-ids">
    <flag name="type"/>
    <formal-name>Document Identifier</formal-name>
    <description>Any sort of document identifier, name, code, path or other indicator of where and how this document
      may be located, compared or validated. Given appropriate qualification via its <code>type</code> and <code>rel</code>, this value may point to <q>the same</q> or <q>another version</q> of the document.</description>
    <remarks>
      <p>Flags <code>rel</code> and <code>type</code> can qualify the kind and use of document identifier, in particular whether the value is to be attributed to the given instance, or to another instance, source or resource.</p>
      <p>Specific usage rules, nomenclatures and recognized file types e.g. DOIs, CMS locators, etc
        etc., may be defined at application level. The value of this field may also be a hash or check sum.</p>
    </remarks>
  </define-field>

  <define-field name="prop" group-as="properties">
    <flag name="class"/>
    <formal-name>Property</formal-name>
    <description>A property associated with the document</description>
    <remarks><p>Wherever permitted, a <code>doc-id</code> should be used in preference to this field when the property is a document identifer of any kind.</p></remarks>
  </define-field>

  <define-assembly name="party" group-as="parties">
    <flag name="id" datatype="ID"/>
    <flag name="role-id"/>
    <formal-name>Party (organization or person)</formal-name>
    <description>A responsible entity, either singular (an organization or person) or collective (multiple persons)</description>
    <remarks>
      <p>As contents one of <code>org</code> or <code>person</code> is required, or both; there may be only one <code>org</code>, but many <code>person</code>s.</p>
      <p>Note that persons can also be indicated with organizational affiliations by using
        <code>orgname</code> inside <code>person</code>. Contact information in that
        case belongs to the person, not the organization: use <code>org</code> when an
      organization as such serves as a documented party.</p>
    </remarks>
    <model>
      <assemblies named="person"/>
      <assembly named="org"/>
      <assembly named="notes"/>
    </model>
  </define-assembly>

  <define-assembly name="person" group-as="persons">
    <formal-name>Person</formal-name>
    <description>A person, with contact information</description>
    <model>
      <field    named="person-name"/>
      <field    named="short-name"/>
      <field    named="org-name">
        <description>Affiliated organization</description>
      </field>
      <fields   named="person-id"/>
      <fields   named="org-id"/>
      <assembly named="address"/>
      <fields   named="email"/>
      <fields   named="phone"/>
      <fields   named="url"/>
      <assembly named="notes"/>
    </model>
  </define-assembly>

  <define-assembly name="org">
    <formal-name>Organization</formal-name>
    <description>An organization or legal entity (not a person), with contact information</description>
    <model>
      <field    named="org-name"/>
      <field    named="short-name"/>
      <fields   named="org-id"/>
      <assembly named="address"/>
      <fields   named="email"/>
      <fields   named="phone"/>
      <fields   named="url"/>
      <assembly named="notes"/>
    </model>
  </define-assembly>

  <define-field name="person-id" group-as="person-ids">
    <flag name="type"/>
    <formal-name>Personal Identifier</formal-name>
    <description>An identifier for a person (such as an ORCID) using a designated scheme.</description>
  </define-field>

  <define-field name="org-id" group-as="organization-ids">
    <flag name="type"/>
    <formal-name>Organization Identifier</formal-name>
    <description>An identifier for an organization using a designated scheme.</description>
  </define-field>

  <define-assembly name="hlink" group-as="hashed-links">
    <flag name="href" datatype="anyURI" required="yes"/>
    <flag name="rel"  datatype="NCName"/>
    <flag name="media-type"/>
    <formal-name>Hashed link</formal-name>
    <description>A pointer to an external document with optional hash for verification</description>
    <remarks>
      <p>This is different from unstructured <code>link</code>, which makes no provision for a hash or formal title. It is also different from the element of the same name once proposed for HTML.</p>
    </remarks>
    <model>
      <field  named="title"/>
      <fields named="hash"/>
    </model>
  </define-assembly>

  <define-flag name="rel" datatype="NCName">
    <formal-name>Relation</formal-name>
    <description>Purpose of the link</description>
  </define-flag>

  <define-flag name="media-type" datatype="string">
    <formal-name>Media type</formal-name>
    <description>Describes the media or MIME type of a linked resource</description>
  </define-flag>

  <define-field name="person-name">
    <formal-name>Person Name</formal-name>
    <description>Full (legal) name of an individual</description>
  </define-field>

  <define-field name="org-name">
    <formal-name>Organization Name</formal-name>
    <description>Full (legal) name of an organization</description>
    <remarks>
      <p>Only when this element is used directly within <code>org</code> can it be accepted of the name of the thing to which it is attached. This element may also be used directly on <code>person</code> to name an affiliated organization.</p>
      <p><code>href</code> can be used to provide external links or internal links to other elements. The sibling <code>org-id</code> element
        (similarly for <em>affiliated</em> organizations) can also be used to link (for example to organizations listed elsewhere as parties.)</p>
    </remarks>
  </define-field>

  <define-field name="short-name">
    <formal-name>short-name</formal-name>
    <description>A common name, short name or acronym</description>
    <remarks>
      <p>This element is not expected to be used to identify individual persons, but rather an
        organization or system.</p>
    </remarks>
  </define-field>

  <define-assembly name="address">
    <formal-name>Address</formal-name>
    <description>A postal address</description>
    <model>
      <fields named="addr-line"/>
      <field  named="city"/>
      <field  named="state"/>
      <field  named="postal-code"/>
      <field  named="country"/>
      <!-\- More address stuff -\->
    </model>
  </define-assembly>


  <define-field name="addr-line" group-as="postal-address">
    <formal-name>Address line</formal-name>
    <description>A single line of an address</description>
  </define-field>

  <define-field name="city">
    <formal-name>City</formal-name>
    <description>City, town or geographical region for mailing address</description>
  </define-field>

  <define-field name="state">
    <formal-name>State</formal-name>
    <description>State, province or analogous geographical region for mailing address</description>
  </define-field>

  <define-field name="postal-code">
    <formal-name>Postal Code</formal-name>
    <description>Postal or ZIP code for mailing address</description>
  </define-field>

  <define-field name="country">
    <formal-name>Country</formal-name>
    <description>Country for mailing address</description>
  </define-field>

  <define-field name="email" group-as="email-addresses">
    <formal-name>Email</formal-name>
    <description>Email address</description>
  </define-field>

  <define-field name="phone" group-as="telephone-numbers">
    <formal-name>Telephone</formal-name>
    <description>Contact number by telephone</description>
  </define-field>

  <define-field name="url" group-as="URLs">
    <formal-name>URL</formal-name>
    <description>URL for web site or Internet presence</description>
  </define-field>

  <define-assembly name="notes">
    <formal-name>Notes</formal-name>
    <description>Any notes with further information</description>
    <model>
      <prose/>
    </model>
  </define-assembly>

  <define-field name="desc">
    <formal-name>Description</formal-name>
    <description>A short description</description>
  </define-field>

  <define-assembly name="resource" group-as="resources">
    <flag name="type"/>
    <flag name="media-type"/>
    <formal-name>Resource</formal-name>
    <description>A resource to inform or authenticate the present document.</description>
    <remarks>
      <p>Typically this information item describes and points to a mirror or other (authoritative or
        informative) copy of a document, or of a resource helpful (necessary) for interpreting it,
        such as its metaschema or documentation. It may offer a (persistent) link to a
        <q>best available</q> version, or to an outdated version, as indicated by its
        <code>rel</code>.</p>
    </remarks>
    <model>
      <field    named="title"/>
      <fields   named="author"/>
      <field    named="publication-date"/>
      <field    named="version"/>
      <fields   named="doc-id"/>
      <fields   named="prop"/>
      <assemblies named="hlink"/>
      <assembly named="notes"/>
    </model>
  </define-assembly>

  <define-field name="hash" group-as="hashes">
    <flag name="algorithm"/>
    <formal-name>Hash</formal-name>
    <description>A document hash or other value subject to cryptographic authentication</description>
    <remarks>
      <p>When appearing as part of a resource (data object), the hash should apply to the referenced object.</p>
    </remarks>
  </define-field>


  <define-flag name="algorithm" datatype="string">
    <formal-name>Hash algorithm</formal-name>
    <description>Method by which a hash is derived</description>
    <remarks><p>One of the following is recognized: MD5, SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, RIPEMD-160. See <a href="https://www.w3.org/TR/xmlsec-algorithms/#digest-method">XML Security Algorithm Cross-Reference</a> (W3C, April 2013) for more information.</p></remarks>
  </define-flag>-->
   <!-- previously removed
	<define-assembly name="role" group-as="roles">
    <flag name="id" datatype="ID" required="yes"/>
    <formal-name>Role</formal-name>
    <description>Defining a role to be assigned to a party or agent</description>
    <remarks>
      <p>Permissible values to be determined closer to the application (e.g. by a receiving
        authority).</p>
    </remarks>
    <model>
      <field named="title"/>
      <field named="short-name"/>
      <field named="desc"/>
    </model>
  </define-assembly>
 -->
   <!--  <define-flag name="href" datatype="anyURI">
    <formal-name>Hypertext reference</formal-name>
    <description>A relative or absolute URI indicating a resource available on the Internet.</description>
  </define-flag>

  <define-assembly name="extra-meta">
    <formal-name>Extra metadata</formal-name>
    <description>Container for (system-defined) metadata</description>
    <model>
      <choice>
        <assemblies named="meta-group"/>
        <fields named="meta"/>
      </choice>
      <assembly named="notes"/>
    </model>
  </define-assembly>

  <define-assembly name="meta-group" group-as="metadata-groups">
    <flag name="term"/>
    <flag name="type"/>
    <formal-name>Metadata group</formal-name>
    <description>Custom- or application-defined annotated metadata.</description>
    <model>
      <fields     named="meta"/>
      <assemblies named="meta-group"/>
      <assembly   named="notes"/>
    </model>
  </define-assembly>

  <define-field name="meta" group-as="metadata-fields">
    <flag name="term"/>
    <flag name="type"/>
    <formal-name>Metadata field value</formal-name>
    <description>Any customized or specialized metadata value.</description>
  </define-field>

  <define-flag name="term" datatype="string">
    <formal-name>Metadata term</formal-name>
    <description>A classification (according to any schema or taxonomy) of a metadata value or set of values.</description>
  </define-flag>
-->
   <!--      BORROWED FROM PROFILE METASCHEMA AND MODIFIED    -->
   <!-- The following needs discussion/attention. It may not be the final solution. -->
   <!--	<define-assembly name="import" group-as="imports">
		<flag name="href" datatype="anyURI" required="yes"/>
		<formal-name>Import resource</formal-name>
		<description>Makes information from an external component file available to this component
			file.</description>
		<remarks>
			<p>This is typically used when defining components of type="capability", to identify the
				individual components the form the larger capabiity.</p>
			<p>This is also used for definining provision information, involving components from
				multiple sources. </p>
		</remarks>
		<model>
			<assembly named="include"/>
			<!-\- assembly named="exclude"/ -\->
		</model>
		<example>
			<import href="../vendor/components/component_file.xml" xmlns="http://csrc.nist.gov/ns/oscal/example">
				<include>
					<call component-id="comp02"/>
				</include>
			</import>
		</example>
	</define-assembly>

	<define-assembly name="include" group-as="includes">
		<formal-name>Include controls</formal-name>
		<description>Specifies which controls and subcontrols to include from the resource (source catalog) being
			imported</description>
		<remarks>
			<p>To be schema-valid, this element must contain either (but not both) a single
				<code>all</code> element, or a sequence of <code>call</code> elements.</p>
			<p>If this element is not given, it is assumed to be present with contents <code>all</code>
				(qv); i.e., all controls are included by default, unless the <code>include</code>
				instruction calls controls specifically.</p>
		</remarks>
		<model>
			<choice>
				<field named="all"/>
				<fields named="call"/>
				<!-\- assemblies named="match" group-as="pattern-selectors"/-\->
			</choice>
		</model>
	</define-assembly>

	<define-field name="all" as="empty">
		<flag name="with-subcontrols"/>
		<formal-name>Include all</formal-name>
		<description>Include all controls from the imported resource (catalog)</description>
		<remarks>
			<p>This element provides an alternative to calling controls and subcontrols individually
				from a catalog. But this is also the default behavior when no <code>include</code>
				element is given in an <code>import</code>; so ordinarily one might not see this element
				unless it is for purposes of including its <code>@with-subcontrols='yes'</code>
			</p>
		</remarks>
	</define-field>

	<define-field name="call" group-as="calls" as="string">
		<flag name="component-id" datatype="NMTOKEN"/>
		<formal-name>Call</formal-name>
		<description>The call element imports the component definition identified by the
			@component-id attribute in the external component file.</description>
		<remarks>
			<p>This is typically used when defining components of type="capability", to identify the
				individual components the form the larger capabiity.</p>
			<p>This is also used for definining provision information, involving components from
				multiple sources. </p>
		</remarks>
		<example>
			<import href="../vendor/components/component_file.xml" xmlns="http://csrc.nist.gov/ns/oscal/example">
				<include>
					<call component-id="comp02"/>
				</include>
			</import>
		</example>
	</define-field>

	<define-flag datatype="NCName" name="with-subcontrols">
		<formal-name>Include subcontrols with control</formal-name>
		<description>Whether subcontrols should be implicitly included, if not called.</description>
	</define-flag>
-->
<!--   <define-field name="prose" as-type="markup-multiline">
      <formal-name>Prose</formal-name>
      <description>Prose permits multiple paragraphs, lists, tables etc.</description>
   </define-field>
--></METASCHEMA>
