<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../build/metaschema/toolchains/xslt-M4/validate/metaschema-check.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<METASCHEMA xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns="http://csrc.nist.gov/ns/oscal/metaschema/1.0"
            xsi:schemaLocation="http://csrc.nist.gov/ns/oscal/metaschema/1.0 ../../build/metaschema/toolchains/xslt-M4/validate/metaschema.xsd">
   <schema-name>OSCAL Assessment Results Format</schema-name>
   <schema-version>1.0.0-milestone3</schema-version>
   <short-name>oscal-ar</short-name>
   <namespace>http://csrc.nist.gov/ns/oscal/1.0</namespace>
   <remarks>
      <p>The OSCAL assessment results format is used to describe the information typically provided by an assessor following an assessment.</p>
      <p>The root of the OSCAL assessment results format is <code>assessment-results</code>.</p>
   </remarks>
   <!-- IMPORT STATEMENTS -->
   <import href="oscal_metadata_metaschema.xml"/>
   <import href="oscal_assessment-common_metaschema.xml"/>
   <!-- TOP LEVEL ASSEMBLY -->
   <define-assembly name="assessment-results">
      <formal-name>Security Assessment Results (SAR)</formal-name>
      <description>Security assessment results, such as those provided by a FedRAMP assessor in the FedRAMP Security Assessment Report.</description>
      <root-name>assessment-results</root-name>
      <define-flag name="uuid" required="yes" as-type="uuid">
         <formal-name>Assessment Results Universally Unique Identifier</formal-name>
         <description>Uniquely identifies this assessment results file. This UUID must be changed each time the content of the results changes.</description>
      </define-flag>
      <model>
         <assembly ref="metadata" min-occurs="1" max-occurs="1"/>
         <assembly ref="import-ap" min-occurs="1" max-occurs="1">
            <remarks>
               <p>Used by the SAR to import information about the original plan for assessing the system.</p>
            </remarks>
         </assembly>
         <!-- CHANGED: "objectives" to "reviewed-controls" -->
         <assembly ref="reviewed-controls" min-occurs="1" max-occurs="1"/>
         <assembly ref="assessment-subjects" min-occurs="0" max-occurs="1"/>
         <assembly ref="assets" min-occurs="0" max-occurs="1"/>
         <!-- CHANGED: "assessment-activities" to "assessment-activity", allowed more than one. -->
         <assembly ref="assessment-activity" min-occurs="0" max-occurs="unbounded">
            <group-as name="assessment-activities"/>
         </assembly>
         <!-- CHANGED: Moved "schedule" to top level (from assessment-activities). Changed name to "assessment-log" -->
         <assembly ref="schedule" min-occurs="0" max-occurs="1">
            <use-name>assessment-log</use-name>
         </assembly>
         <assembly ref="result" min-occurs="1" max-occurs="unbounded">
            <!-- CHANGED: "results" to "result" -->
            <use-name>result</use-name>
            <!-- CHANGED: "results_group" to "results" -->
            <group-as name="results" in-json="ARRAY"/>
         </assembly>
         <assembly ref="back-matter" min-occurs="0" max-occurs="1"/>
      </model>
   </define-assembly>


   <!-- ********** RESULTS Assembly ********** -->
   <define-assembly name="result">
      <formal-name>Assessment Result</formal-name>
      <description>Used by the assessment results and POA&amp;M. In the assessment results, this identifies all of the assessment observations and findings, initial and residual risks, deviations, and disposition. In the POA&amp;M, this identifies initial and residual risks, deviations, and disposition.</description>
      <define-flag name="uuid" required="yes" as-type="uuid">
         <formal-name>Results Universally Unique Identifier</formal-name>
         <description>Uniquely identifies this set of results. This UUID may be referenced elsewhere in an OSCAL document when refering to this information. Once assigned, a UUID should be consistantly used for a given set of results across revisions.</description>
      </define-flag>
      <model>
         <define-field name="title" min-occurs="1" max-occurs="1" as-type="markup-line">
            <formal-name>Results Title</formal-name>
            <description>The title for this set of results.</description>
         </define-field>
         <!-- CHANGE: Added WITH_WRAPPER to description -->
         <define-field name="description" min-occurs="1" max-occurs="1" in-xml="WITH_WRAPPER" as-type="markup-multiline">
            <formal-name>Results Description</formal-name>
            <description>A human-readable description of this set of test results.</description>
         </define-field>
         <assembly ref="origination" min-occurs="0" max-occurs="1"/>
         <field ref="property" min-occurs="0" max-occurs="unbounded">
            <!-- CHANGE: props to properties -->
            <group-as name="properties" in-json="ARRAY"/>
         </field>
         <assembly ref="annotation" max-occurs="unbounded">
            <group-as name="annotations" in-json="ARRAY"/>
         </assembly>
         <assembly ref="link" max-occurs="unbounded">
            <group-as name="links" in-json="ARRAY"/>
         </assembly>
         <define-field name="start"
            as-type="dateTime-with-timezone"
            min-occurs="1"
            max-occurs="1">
            <formal-name>start field</formal-name>
            <description>Date/time stamp identifying the start of the evidence collection reflected in these results.</description>
         </define-field>
         <define-field name="end"
            as-type="dateTime-with-timezone"
            min-occurs="1"
            max-occurs="1">
            <formal-name>end field</formal-name>
            <description>Date/time stamp identifying the end of the evidence collection reflected in these results. In a continuous motoring scenario, this may contain the same value as start if appropriate.</description>
         </define-field>
         <assembly ref="finding" min-occurs="1" max-occurs="unbounded">
            <group-as name="findings" in-json="ARRAY"/>
         </assembly>
         <field ref="remarks" in-xml="WITH_WRAPPER" min-occurs="0" max-occurs="1"/>
      </model>
   </define-assembly>
   
   <define-assembly name="finding">
      <formal-name>Finding</formal-name>
      <description>Describes an individual finding.</description>
      <define-flag name="uuid" required="yes" as-type="uuid">
         <formal-name>Finding Universally Unique Identifier</formal-name>
         <description>Uniquely identifies this finding. This UUID may be referenced elsewhere in an OSCAL document when refering to this information. Once assigned, a UUID should be consistantly used for a given finding across revisions.</description>
      </define-flag>
      <model>
         <define-field name="title" min-occurs="1" as-type="markup-line">
            <formal-name>Finding Title</formal-name>
            <description>The title for this finding.</description>
         </define-field>
         <!-- CHANGE: Added WITH_WRAPPER to description -->
         <define-field name="description" min-occurs="1" in-xml="WITH_WRAPPER" as-type="markup-multiline">
            <formal-name>Finding Description</formal-name>
            <description>A human-readable description of this finding.</description>
         </define-field>
         <field ref="property" max-occurs="unbounded">
            <!-- CHANGE: props to properties -->
            <group-as name="properties" in-json="ARRAY"/>
         </field>
         <assembly ref="annotation" max-occurs="unbounded">
            <group-as name="annotations" in-json="ARRAY"/>
         </assembly>
         <assembly ref="link" max-occurs="unbounded">
            <group-as name="links" in-json="ARRAY"/>
         </assembly>
         <assembly ref="origination" min-occurs="0" max-occurs="1">
            <!-- CHANGE: moved in sequence -->
         </assembly>
         <define-field name="collected" as-type="dateTime-with-timezone" min-occurs="1" max-occurs="1">
            <formal-name>collected field</formal-name>
            <description>Date/time stamp identifying when the finding information was collected.</description>
         </define-field>
         <define-field name="expires" as-type="dateTime-with-timezone" min-occurs="0" max-occurs="1">
            <formal-name>expires field</formal-name>
            <description>Date/time identifying when the finding information is out-of-date and no longer valid. Typically used with continuous assessment scenarios.</description>
         </define-field>
         <assembly ref="objective-status" min-occurs="0" max-occurs="1"/>
         <field ref="implementation-statement-uuid" min-occurs="0" max-occurs="1"/>
         <assembly ref="observation" min-occurs="0" max-occurs="unbounded">
            <group-as name="observations" in-json="ARRAY"/>
         </assembly>
         <field ref="threat-id" min-occurs="0" max-occurs="unbounded">
            <group-as name="threat-ids" in-json="ARRAY"/>
         </field>
         <assembly ref="risk" min-occurs="0" max-occurs="unbounded">
            <group-as name="risks" in-json="ARRAY"/>
         </assembly>
         <define-field name="party-uuid" min-occurs="0" max-occurs="unbounded">
            <formal-name>party-uuid field</formal-name>
            <description>The person who collected the evidence or made the observation.</description>
            <group-as name="party-uuids" in-json="ARRAY"/>
         </define-field>
         <field ref="remarks" in-xml="WITH_WRAPPER" min-occurs="0" max-occurs="1"/>
      </model>
   </define-assembly>
   

   <!-- Assessment Plan Import -->
   <define-assembly name="import-ap">
      <formal-name>Import Assessment Plan</formal-name>
      <description>Used by assessment-results to import information about the original plan for assessing the system.</description>
      <define-flag name="href" required="yes" as-type="uri-reference">
         <formal-name>Assessment Plan Reference</formal-name>
         <description>>A resolvable URL reference to the assessment plan governing the assessment activities.</description>
         <remarks>
            <p>The value of the <code>href</code> can be an internet resource, or a local reference using a fragment e.g. #fragment that points to a <code>back-matter</code> <code>resource</code> in the same document.</p>
            <!-- TODO: Add a link to "within the scope of the containing OSCAL document" to point to documentation of identification scopes" -->
            <p>If a local reference using a fragment is used, this will be indicated by a fragment "#" followed by an identifier which references an identified <code>resource</code> in the document's <code>back-matter</code> or another object that is within the scope of the containing OSCAL document.</p>
            <p>If an internet resource is used, the <code>href</code> value will be an absolute or relative URI pointing to the location of the referenced resource. A relative URI will be resolved relative to the location of the document containing the link.</p>
         </remarks>
      </define-flag>
      <model>
         <field ref="remarks"
            in-xml="WITH_WRAPPER"
            min-occurs="0"
            max-occurs="1"/>
      </model>
   </define-assembly>
</METASCHEMA>
